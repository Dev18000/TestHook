# TestHook Blazor App

## Описание

Это Blazor-приложение для получения и отображения данных, поступающих через вебхуки. Приложение использует SignalR для передачи данных в реальном времени от сервера к клиентам, а также интеграцию с внешними API для получения данных через вебхуки.

### Основные возможности:

- Подписка и получение данных через SignalR.
- Отправка данных с помощью вебхуков в формате JSON.
- Отображение полученных данных в реальном времени.
- Управление подпиской/отпиской через `SubscriptionService`.

## Основные компоненты

### 1. **Контроллер TestHookController**

- **Эндпоинт `/api/TestHook/TestWebHook`**: 
  Обрабатывает POST-запросы, содержащие данные вебхука, и пересылает их подписчикам через SignalR.

### 2. **Модель данных SimpleDataForHookTest**

- Используется для передачи данных вебхука.
  - Поля:
    - `Name`: Имя пользователя.
    - `Age`: Возраст пользователя.

### 3. **UpdateHub**

- Управляет отправкой сообщений через SignalR всем подписчикам.
- **Метод `SendUpdate`**: Отправляет данные всем подключённым клиентам.

### 4. **Страница Blazor**

- **Страница `/planning`**:
  - Подключается к SignalR хабу для получения обновлений.
  - Отображает полученные данные в реальном времени.
  - Поддерживает переподключение в случае разрыва связи.

### 5. **HookService**

- Управляет подписчиками и отправляет данные вебхука всем зарегистрированным обработчикам.

### 6. **SubscriptionService**

- Отвечает за управление подпиской и отпиской на вебхуки через HTTP-запросы к внешним API.

## Используемые технологии и зависимости

- **Blazor** для фронтенда.
- **ASP.NET Core** для серверной части.
- **SignalR** для работы с данными в реальном времени.
- **HttpClient** для отправки вебхуков.
- **Newtonsoft.Json** для сериализации данных в формат JSON.

### Необходимые пакеты:

- `Microsoft.AspNetCore.SignalR.Client`
- `Newtonsoft.Json`
- `Microsoft.AspNetCore.SignalR`

## Настройка и запуск

### 1. Подготовка

Убедитесь, что у вас установлен .NET SDK и Visual Studio.

### 2. Установка зависимостей

Выполните команду для установки необходимых пакетов:

```
dotnet restore
```

### 3. Настройка SignalR

Добавьте SignalR в контейнер DI в Program.cs:

```
builder.Services.AddSignalR();
```

### 4. Запуск приложения

Запустите приложение с помощью команды:

```
dotnet run
```

Откройте браузер и перейдите на страницу:

```
https://localhost:5001/planning
```

### 5. Тестирование вебхуков

Для тестирования вебхуков можно использовать Postman или cURL:

Пример запроса:

```
curl -X POST https://localhost:5001/api/TestHook/TestWebHook -H "Content-Type: application/json" -d '[{"name": "John Doe", "age": 30}]'
```

https://github.com/Dev18000/TestHookApiSimpleTest


